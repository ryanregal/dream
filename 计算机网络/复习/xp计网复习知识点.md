# 思维导图

<img src="C:\Users\icebear\AppData\Roaming\Typora\typora-user-images\image-20220612144909966.png" alt="image-20220612144909966" style="zoom:80%;" />

![image-20220612145025727](C:\Users\icebear\AppData\Roaming\Typora\typora-user-images\image-20220612145025727.png)

<img src="C:\Users\icebear\AppData\Roaming\Typora\typora-user-images\image-20220612145158874.png" alt="image-20220612145158874" style="zoom:80%;" />



# 一	、绪论和传输介质	

## 0、各层作用⭐

- 大概考一层

  <img src="C:\Users\icebear\AppData\Roaming\Typora\typora-user-images\image-20220612101601921.png" alt="image-20220612101601921" style="zoom:80%;" />

- 各层名称、传输最小单位、网络设备名、主要协议、编址方案、同类协议、主要作用。

- 第 5层：应用层，无，**七层交换机**，HTTP等，无，DNS、POP3等，具体应用服务；

- 第 4 层：传输层，**数据段、数据报**，**四层交换机**，TCP、UDP，**端口号**，STCP，**将网络数据分配到具体的进程**；

- 第 3 层：网络层，数据报，**路由器（网关）、三层交换机**，IP，IP 地址，IPv6，**提供统一的网络互联，隐藏底层网络异构的细节**；

- 第 2 层：网络接口层，帧，网桥、交换机，Ethernet，MAC 地址，（X.25、令牌环、电话网等），**网卡竞争、复用传输信道**；

- 第 1 层：物理层，位，**中继器、集线器**，光，无，电、无线电，**位的传输**。

  

## 1、信号的能量形式

- 电的：双绞线、同轴电缆
- 光的：光纤、红外线、激光
- 电磁波（无线电波）：地面无线电、卫星

## 2、屏蔽与非屏蔽双绞线、同轴电缆

- 非屏蔽双绞线（Unshielded Twisted Pair）：柔韧性强，成本低
- 同轴电缆（Coaxial Cable）：屏蔽能力强，成本高
- 屏蔽双绞线（Shielded Twisted Pair）：折中

### 双绞线：

- 既能传输模拟信号，也能传输数字信号
- 通信距离一般为几到几十公里（距离太长，信号会衰减，需要用中继器整形和放大）
- CAT-3，带宽16MHz，曾常用在10Mbps以太网络
- CAT-5，带宽100MHz，常用在快速以太网（100Mbit/s）中
- CAT-5e，带宽125MHz，常用在快速以太网（100Mbit/s）和吉比特以太网（1000Mbit/s）

### 同轴电缆：

- 按阻抗分为![img](file:///C:\Users\icebear\AppData\Local\Temp\ksohtml10844\wps60.jpg)同轴电缆和![img](file:///C:\Users\icebear\AppData\Local\Temp\ksohtml10844\wps61.jpg)同轴电缆
- ![img](file:///C:\Users\icebear\AppData\Local\Temp\ksohtml10844\wps62.jpg)基带同轴电缆（Baseband Coaxial Cable)
  -  以10Mb/s传输基带信号的距离可达1km
  - 用于以太网的标准：10Base2，10Base5
- ![img](file:///C:\Users\icebear\AppData\Local\Temp\ksohtml10844\wps63.jpg)：
  - 宽带同轴电缆（Broadband Coaxial Cable) 
  - 频率可高达500MHz以上，传输距离可达100km  用于传输有线电视的模拟信号
  - 分为多个信道（使用电缆调制技术，电视和数据可在一条电缆上混合传输）

## 3、单模与多模光纤

多模突变光纤：便宜，纤芯密度不变，覆层间突变多模渐变光纤：纤维密度越接近边缘越大，减少反射单模光纤：贵，直径小，长距离，高比特率

| 项目       | 单模光纤 | 多模光纤   |
| ---------- | -------- | ---------- |
| 距离       | 长       | 短         |
| 数据传输率 | 高       | 低         |
| 光源       | 激光     | 发光二极管 |
| 信号衰减   | 小       | 大         |
| 端接       | 较易     | 较难       |
| 造价       | 高       | 低         |

 

# 二	、局域异步通信



## 1、RS232-C标准⭐

### 机械特征

- D型插座，**至少有三根针**，分别是接地、发送和接收

### 电气特征

- -3V~-15V代表逻辑1，3V~15V代表逻辑0

### 帧格式特征

- 有一位开始位和一位结束位
- 空闲周期大于0比特
- **以字符为传输单位**，每个字符7个比特表示，以7个比特为传输单位。



![image-20220612102308280](C:\Users\icebear\AppData\Roaming\Typora\typora-user-images\image-20220612102308280.png)

### CHOICE

- 上图是8位字符[，ASCII为91。（**字节大端序，位小端序**）

- full duplex transmission:全双工传输
- at least one idle period:至少一个空闲位

## 2、串行与并行传输

- 串行（Serial）：同时只传输一位
- 并行（Parallel）：多位同时传输

## 3、同步与异步传输

- 同步（Synchronous）：连续发生，需事先约定有效数据的位置，两个数据项之间没有间隔
- 异步（Asynchronous）：在任意时间发生，两个数据项之间可以有任意的时延

## 4、单工、半双工和全双工传输

- 单工：单方向通信（只能发送或接受）

- 半双工：可双向通信，但同一时间只能单向通信全双工：同一时刻可双向通信

## 5、DCE和DTE设备的概念

- DCE：数据通讯设备
- DTE：数据终端设备

- 以下为10Mbps以太网RJ-45接口，DCE和DTE的连线

- 在UDP上以100Mbps及以上的局域网将使用全部四对线



## 6、带宽、波特率和比特率带宽（Bandwidth）

- 传统定义：某个信号所具有的频带宽度

- 新定义：该信号各种不同频率成分所占据的频率范围（特定信号通常由许多不同频率成分组成）

## 数字信道的带宽：

- 在信道上能够传送的数字信号的速率，即数据率或比特率单位：b/s，或bps

- 根据香农理论，带宽也有时候被称为吞吐量

## 波特率（Baud）

- 带宽的单位：波特（也称波特率）

- 传输介质中信号变化的速率，每秒传输的符号数（真正的硬件不能瞬时改变电压，带宽有限）

- 仅在二进制环境下为bps

- 发送方和接收方硬件的波特率不同，将发生错误接收方计时器每个位的等待时长不恰当

- 检测错误时，接收机多次测量每个比特的电压，并比较测量结果。如果电压都不一致，或停止位没有  在预期时间发生时，接收器会报告错误，成为帧错误

## 7、奈奎斯特定理和香农定理

<img src="C:\Users\icebear\AppData\Roaming\Typora\typora-user-images\image-20220612102752081.png" alt="image-20220612102752081" style="zoom:80%;" />

## 物理意义：

- 奈：硬件带宽和理论发送速率之间的关系。
  - 提高：带宽和电压值。
- 香：有噪声的传输系统可以到达的最大数据速率
  - 提高：信噪比。



# 三	、远程通信	

## 模拟信号

- 时间连续，幅值离散

## 数字信号

- 时间离散，幅值连续

## 模拟-数字信号转换

- 利用奈奎斯特定理，以大于信号带宽两倍的频率进行采样，则原来的模拟信号可以从采样样本中完全  重建出来

## 基带和宽带

**基带：**原始电信号所固有频带。

- **基带信号：**将数字1、0用电压表示。 

**宽带：**同时传输多个信号的通信系统。

- 宽带信号：**基带信号调制后的频分复用模拟信号**。

## 调制解调：

- 调制：**用基带信号控制载波信号的参量变化，将信息荷载其上形成已调信号以在信道内传输**。包括调幅、调频、调相。 
- 解调：**将已调信号恢复为基带信号的过程**，为调制逆过程。包括解调幅、解调频、解调相。 

## 解码编码：

- 将0-1序列按照相应的解码规则转化成人类能够识别的字符（**能量-比特**）
- 将字符按照相应的编码类型转化成计算机能够识别的0-1序列（**比特-能量**）

## 3、常用调制技术

- 调频和调幅技术每发送一个信号位都需要至少一个载波周期。
- 一般是一个载波周期发送1bit信息。

## 调幅（Amplitude Modulation, AM）

- 更改振幅

## 调频（Frequency Modulation, FM）

- 更改载波的频率

## 调相（Phase Shift modulation, PM）

- 更改相位

## 4、调制解调器（Modem） 

## 调制器（Modulator）

- 执行调制功能的器件

## 解调器（Demodulator）

- 执行解调制功能的器件

## 5、复用与解复用、时分复用、频分复用、波分复用

### 复用（Multiplexing）

- **指多个信源的信息流组合在一条共享介质上传输**

- 分为频分多路复用、波分多路复用、时分多路复用、码分多路复用

- **频分：**收音机无线广播，ADSL

  **波分：光纤**

  **时分：以太网**

### 解复用（Demultiplexing）

- **指将信息流组合分隔回分开的信息流**

### 频分多路复用（Frequency-Division Multiplexing, FDM）

- 载波带宽被划分为多种**不同频带的子信道**，每个子信道可以并行传送一路信号的一种多路复用技术  多个载波可以在同一时间通过同一导线不相互干扰

- 高吞吐量（throughput）

### 波分多路复用（Wave Division Multiplexing , WDM）

- 光的频率很高，习惯用波长表示光波，即光的FDM就是WDM 在一根光纤上发送多个光波

- 在接收端，光学棱镜用来分离频率

### 时分多路复用（Time-Division Multiplexing, TDM）

- **将时间划成等长的时分复用帧**

- 每个用户在每一帧中占用固定序号的时隙，所有用户在不同时间占用相等的频带宽度

- **同步时分多路复用（Synchronous TDM）**：每个用户依次、均匀地占用信道

- **统计时分多路复用（Statistical   TDM）**：使用时分多路复用系统传输数据时，由于计算机数据的突发性质，用户对分配的子信道的利用率一般是不高的，故通过动态按需分配共用信道的时隙，优化信道的  利用率



# 四、差错控制	

- 传输差错的来源是干扰、失真、衰减。
- 传输差错的类型是单个差错、突发差错和擦除（模糊）

## 1、奇偶校验（Parity Check）的简单计算

- 发送方根据消息序列计算一个额外的位附加在原有消息序列后，称为奇偶位接收方收到所有位后，校验并丢弃奇偶位

## 两种机制：奇和偶

- 奇校验中**消息和校验位**有**奇数个1**
- 偶校验有偶数个1 发送和接收方应该有相同的模式

## 2、Internet校验和的计算

- 把消息每16位作为一个**整数计算和**
- 若结果大于16位，则重复上述过程，最后取反
- 3FF0

## 3、循环冗余校验码（Cyclic Redundancy Codes）

- 一种根据网络数据包或文件等数据**产生简短固定位数校验码**的哈希函数，主要用来检测或校验数据传输或保存后可能出现的错误
- 无法发现同余错误。

- ## 重要特征

- 任意消息字长出色的错误检测

- 快速硬件实现（位移寄存器，异或门）



# 五	、局域网分组与编址	

## 1、交换技术

## 报文交换

- 数据交换的单位是报文，报文携带有目标地址、源地址等信息。
- 报文交换在交换结点采用的**是存储转发**的方式。
- 特点
  - 无需建立连接、线路利用率高。
  - 由于报文交换**对报文大小没有限制**，要求网络节点需要较大的缓存空间，现在被分组交换所取代。

## 分组交换（Packet Switching）

- 以分组为单位进行传输和交换的存储-转发交换方式采用**统计复用（时分多路复用）**，多个来源争夺共享介质使用

- **特点：**异步，无需建立，性能各异
- **使用分组交换的必要性**
  - 分组技术指的是将通信内容按照一定长度划分为更小的单位。
  - 交换是指通过通信设备之间的层层转发，将通信内容从源地址转发到目的地址。
  - 局域网内的通信主机需要**共享信道**，因此需要对通信内容进行分组，轮流使用信道，避免一方使用时间过长。而局域网内的主机过多，信道发生冲突的概率增大。**通过将其划分为多个分段传输，减少冲突。**
  - 网段和网段之间的分组需要传递，分组需要通过若干次交换，即在通信设备之间层层转发，将通信内容从源地址转发到目的地址。

## 电路交换（Circuit Switching）

- 通信之前在通信双方之间建立一**条被双方独占的物理通道**。多个电路在共享介质上复用，形成虚拟通路

- 类似于电话技术：建立线路，线路交互，中止使用

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | <img src="file:///C:\Users\icebear\AppData\Local\Temp\ksohtml10844\wps77.png" alt="img" style="zoom:80%;" /> |

## 2、网络接口卡（NIC）

### 作用

- 数据的封装和解封
  - 发送时将上一层交下来的数据加上首部和尾部，成为以太网的帧。
  - 接收时将以太网的帧剥去首部和尾部，然后交给上一层。

- 处理**地址识别**
- 帧识别**、**发送和接受帧**（减小CPU的负荷）

### 网卡处理分组

①**检测CRC，判断分组校验码无误。提取目标地址D；**

**②如果网卡为混杂模式，接受；** 

③如果D=本地地址，接受；④如果D=广播地址或者多播地址，接受； 

⑤否则，丢弃分组。 

## 3、MAC（介质访问控制）地址的构成组织唯一标识（高24位）：

- IEEE向厂家分配唯一标识（OUI）、**物理网卡唯一对应的地址。**

- 第一个字节最低位为0表示单播，1表示多播和广播
  - 广播48位全为1

- 第一个字节最低第二位为0表示全局网址，1表示局域网址
- 用于表示**网络设备位置**。地址48位，形式为：姓+名（厂商号+设备号）
  - [姓]高24位由IEEE向厂家分配，[名]低24位由厂家自行分配。 

## 网卡标识符（低24位）

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\icebear\AppData\Local\Temp\ksohtml10844\wps78.png) |

- 厂家自行分配



## 4、单播、广播、多播

## 单播（Unicast）

- 一对一

## 多播（Multicast）

- 一对多，特定地址

- 当一台计算机需要同时向多台计算机传输信息时使用广播

- 网上的所有设备的网卡拷贝数据帧，交给CPU处理，需要与否由CPU决定

## 广播（broadcast）

- 一对全体，48位全为1



## 5、帧结构（头部+载荷）、成帧⭐

- 目的地址[6B]-源地址[6B]-类型[2B]-数据[46~1500B]-CRC32[4B]。 

- 数据少于46B，要填补到46B，满足加上头部64B的要求。超过1500就分片。
- **小于64B的是无效帧**
  - 规定最小尺寸是为了**确保发送站点可以在发送该帧的最后一个比特前检测到冲突**。
  - 10Mbps以太网**在争用期可发送64字节**。若前64字节没有发生冲突，那么后续的数据都不会发生冲突。
  - 若检测到冲突即中止发送，则已发送的数据一定小于64B。
    - 所以小于64B的是无效帧。



## 6、以太网帧结构

![image-20220613003120883](C:\Users\icebear\AppData\Roaming\Typora\typora-user-images\image-20220613003120883.png)

- ### ⭐物理层

  - ### 前同步码[7B]：

    - 56比特交替出现的的0和1

    - 提醒系统有帧到来，以及使到来的帧与计时器同步

  - ### 帧首界定符（SFD）[1B]：

    - 1字节的10101011，标志帧的开始

- ### 数据链路层⭐

  - ### 目的地址：[6B]

    - 6字节，目的物理地址

  - ### 源地址：[6B]

    - 6字节，源物理地址

  - ### 类型：[2B]

    - 2字节，标记了封装在帧中的数据类型

  - ### 数据：[46-1500B]

    - 包含从上层来的数据，应在46~1500字节之间

    - 若上层协议产生数据长度小于46字节，则将其填补到46字节若数据长度超过1500字节，则必须将其进行分片

  - ### 循环冗余校验：[4B]

    - 4字节，CRC-32，用于差错检测



# 六	、以太网、拓扑与无线技术	

- 双绞线以太网：**逻辑总线、物理星型。**
- 传输介质、帧格式、工作原理（CSMA/CD）

## 1、局域网拓扑：总线、星形、环形、网状

####  ① 网状拓扑：点对点连接； 

- 优点：独立安装、独立访问、安全稳定； 
- 缺点：线多成本高； 
- 常用于远距离。

#### ② 星型拓扑：一组计算机通过集线器来传输信息，各节点与中心节点为点对点； 

- 优点：容易增加节点，单节点异常不影响其他节点，容易实现网络监控； 
- 缺点：中心节点故障引起网络瘫痪； 
- 常用于近距离。
- **代表性网络：** ATM（异步传输模式）

#### ③ 环型结构：各节点为封闭环。相邻节点为点对点，非相邻要经过其他节点。 

- 优点：结构简单易安装，节省资源； 
- 缺点：容量有限，难增加新节点，单节点异常影响其他节点； 
- 常用于远距离。 
- **代表性网络**：FDDI

#### ④ 总线型拓扑：所有节点连到一条长电缆。同一时间只能有一台计算机传信号。 

- 优点：安装简单，成本低，单节点异常不影响其他节点； 
- 缺点：介质故障引起网络瘫痪，安全性低，监控难，也难增加新节点；
- 代表性网络：LocalTalk

## 2、以太网介质访问控制策略（CSMA/CD）⭐

- 适用于半双工的传统以太网。 
- **载波侦听多路存取冲突检测**。
- **①载波侦听[发送前]：**站点发送前，监视电缆上是否有其他站点在发送。它阻止了最明显冲突。 
- **②冲突检测[冲突时]：**站点发送过程中，**监视电缆的信号是否与本站信号相同**，不同则终止发送。 
- **③二进制指数退避[冲突后]：**当冲突发生之后，互联网需要从冲突中恢复。标准所规定的最大延迟值是d。
  - 每个检测到冲突的站点选择一个小于d的随机延迟。
  - 如果再次冲突，则选择0~2d之间的随机数。
  - 第n次冲突，延迟时间为0~2^(n-1)d随机。 

 <img src="C:\Users\icebear\AppData\Roaming\Typora\typora-user-images\image-20220613003545156.png" alt="image-20220613003545156" style="zoom:67%;" />



## 3、其他网络类型的特点：LocalTalk、Token Ring、FDDI、ATM

- **Local Talk：**成本低、安装简单；

  - 总线拓扑结构

- **Token Ring：**单点故障会影响； 

- FDDI：单点故障能恢复，成本高；

  - 环状拓扑结构

- **ATM：性能好，没冲突，成本高；** 

  - 星型拓扑结构
  - ATM网络的QoS比以太网更好。
    - **因为其帧是短帧，所有延迟小，又因为面向连接，所有抖动小。**

  

##  4、网络技术的分类：个域网、局域网、城域网、广域网



## 5、WLAN基本概念：蓝牙、蜂窝网络、1~4G、GPS及其速率的大致量级

-  **WIFI>4G>蓝牙**
- 蓝牙（1Mbps左右）



# 七	、局域网的布线、拓扑、接口硬件	

### 1、以太网的粗缆、细缆、双绞线布线

-  粗缆：**总线型**
  - 连接网卡和收发器的电缆为AUI。 
- 细缆：**总线型**
  - 直接连接到使用BNC的计算机背面，成本比粗缆低； 
- 双绞线：**星型**
  - **使用集线器**，计算机和集线器间为RJ-45双绞线； 

### 2、物理和逻辑拓扑

- 物理拓扑星型、逻辑拓扑总线型。 

### 3、冲突域与广播域的概念

-  冲突域：是同一时间内只能有**一台设备发送信息的范围**。
  - 它属于**物理层**范围，可以由数据链路层的设备隔离冲突域，比如**交换机**。
  - 交换机可以缩小冲突域的范围，每一个端口就是一个冲突域。

- 广播域：可以**收到同样广播消息的节点**集合

  - 如果站点发出一个广播信号，**所有能接收收到这个信号的设备范围**称为一个广播域。

  - 它属于**数据链路层**，可以由网络层的设备隔离广播域，比如路由器。路由器的每一个端口就是一个广播

    域。

<img src="C:\Users\icebear\AppData\Roaming\Typora\typora-user-images\image-20220613004008980.png" alt="image-20220613004008980" style="zoom:67%;" />

### 4、中继器（repeater）、集线器（Hub）、网桥（bridge）⭐

-  **中继器**：

  - 工作在**物理层**。**不理解帧格式，也无物理地址，**不区分有效帧和其他信号。 
  - 适用于完全相同的网络互连。 
  - **功能**：
    - 对数据信号**重新发送或转发**，来**扩大网络传输距离。** 
    - 在连接的链路两端分别检测载波信号，对载波信号进行振幅放大，发送到对端。补偿信号衰减，支持远距离传输。

- **集线器：** 

  - 工作在**物理层**。  
    - 所有没有packet，只有signals（信号）
  - analog device （模拟设备）
  - **功能：**
    - **对接收到的信号进行再生整形放大**，以扩大网络的传输距离，**同时把所有结点集中在以它为中心的节点上**。
  - 优点：**使属于不同冲突域的计算机能跨碰撞域通信**，扩大了局域网覆盖范围。 
  - 缺点：冲突域增加，但吞吐量未提高；若不同冲突域使用以太网技术不同，则不能相连。 

- **网桥：** 

  - **工作在数据链路层**，其内的网卡始终处于**混杂**模式。 

    - uses MAC addresses to perform filtering. 
      - 使用MAC地址进行过滤
    -  Computers CANNOT tell whether they are on a single segment or a bridged LAN.
      - 桥接是一种机制，用于连接从一个段到另一段的方向帧；计算机不能知道它们是在单个段上还是在桥接局域网上

  - **功能：**

    - **在链路层实现中继，常用于连接两个或多个局域网。**
    - 功能包括帧监听、帧过滤、帧存储、帧丢弃、帧转发。

  - 网桥的地址表由自学习算法建立而成。

    - 实时根据相邻网段的数据帧，解析源物理地址。根据数据帧源物理地址对物理地址表做更新，通过查询操作，判断数据帧是否需要转发。

  - 网桥接受到帧后，在地址表内寻找： 

    - ①如果目的地址和源地址在同一LAN段，则扔掉此帧； 
      - 因为可以直接接收到这个帧而不需要网桥的转发
    - ②如果目的地址和源地址不在同一LAN段，则转发此帧，**转发前要执行CSMA/CD**； 
    - ③找不到，则发送到除本端口外的其他端口；

    

### 5、交换机、广播风暴与分布式生成树

- 交换机： 

  - **工作在数据链路层。本质是多接口[全双工]的网桥**。 
  - **功能：**
    - **提供一组设备的接口**。保证每个设备在一个独立的网段中。能将网络分成小的冲突域，为每个工作站提供更高的带宽。

  - **最大优点：**独占传输媒体的带宽，而不是共享。 

  - **内部结构**
    - **CPU+RAM+ROM+NIC（网卡）**
    - CPU（数据传输）RAM/ROM（存储）网卡（CRC计算、地址识别、**发送、识别、接受帧**）

  - digital device（数字设备，转发packets）
  - 当交换机端口检测到帧时，如果没有在转发表中找到目的地址
    - 把以太网帧发送到除本端口以外的所有端口。

### 6、区别总结

- 中继器、网桥、交换机

  - 中继器工作在物理层、交换机和网桥工作在数据链路层。

  - 中继器无法识别冲突信号，无法隔离冲突域。**网桥和交换机都可以隔离冲突域，但都不能隔离广播域。**

  - 交换机逻辑上可以视为多口网桥。  

- 传统以太网和交换机连接以太网

  - 交换机连接的以太网宽带更高。传统以太网带宽总和不超过总带宽，使用以太网交换机，用户独占而不是共享传输媒体的带宽。
  - <img src="C:\Users\icebear\AppData\Roaming\Typora\typora-user-images\image-20220612131339482.png" alt="image-20220612131339482" style="zoom: 67%;" />

### 7、五四三二一原则

- 五个网段、四个中继器、三个网段连接计算机（相邻不连）、两个网段不挂在其他结点、一个大型冲突域。

<img src="C:\Users\icebear\AppData\Roaming\Typora\typora-user-images\image-20220612131857971.png" alt="image-20220612131857971" style="zoom:50%;" />



# 八、远程数字连接技术、网络性能	



## 1、Internet接入技术：上行与下行 

- 大多数互联网居民用户遵循非对称模式：接受数据比发送数据多。商业用户则相反。
- **一般ADSL分配信道的策略就是下行大于上行带宽。**

- **上行：**用户传输数据到ISP（互联网服务提供商）。 
- **下行：**ISP传输数据给用户。

## 2、接入技术：宽带与窄带、ISDN、ASDL、电缆调制解调器、无线、光纤 

- ADSL（**非对称数字用户线路**）
  - **采用频分复用。**上行大概800kb，下行大概10Mb

<img src="C:\Users\icebear\AppData\Roaming\Typora\typora-user-images\image-20220612133015668.png" alt="image-20220612133015668" style="zoom:50%;" />

- **ADSL 是自适应的。**

  - 当一对 ADSL 调制解调器的电源打开，**它们探测之间的线路以找到其特点，然后使用对于线路最佳的技术通信**。

  - ADSL 启动时，两端探测可用的频率来确定的何种频率工作正常何种频率相互干扰。同时，两端对各频率的信号进行质量评估，并使用质量来选择调制方案。**如果一个特定的频率具有很高的信噪比**，**ADSL 选择调制编码方案，每个波特传输多位**；如果在一个给定的频率的**质量较低**，ADSL 则**选择每波特编码较少比特的调制方案**。

    

## 3、标准：数字电话标准（T、E）、干线标准（STC、OC、同步光网络） 

## 4、各种网络接入技术与标准大致的速率量级 

## 5、广域网技术的类型：虚电路、数据报、及各自的特点 

## 6、不同类型的网络技术：APANET、PSTN、X.25、帧中继的特点 

- **PSTN：公用电话交换网**
  - **计算机→调制解调器**→编码解码器→长话局→编码解码器→**调制解调器→计算机**

<img src="C:\Users\icebear\AppData\Roaming\Typora\typora-user-images\image-20220612133344539.png" alt="image-20220612133344539" style="zoom:80%;" />

## 7、网络所有权：私有网络、公有网络的定义 

## 8、网络的性能度量：时延、吞吐率、抖动

 

# 九、广域网技术与路由、协议系列	

- 可以使用路由器来在以太网和令环牌之间通信。

## 1、分组交换机的原理、存储与转发

### **分组交换机：** 

- **功能：**存储与转发。 
- **存储：**把分组存储在存储器里； 
- **转发：**解析目的地址，只基于交换机ID[下面的站点号]，发送到对应端口； 

## 2、广域网的概念和分层编址 

- 由于广域网主机多，需要多层寻址方案
  - **站点号**[标识**分组交换机**的唯一编号]+**主机号**[标识**计算机**]。 
  - 广域网使用路由器连接成网络
- 参考编址只要局域网唯一即可，**和端口号无关**。

## 3、路由器功能 

- 路由器主要完成两个功能：一个是路由选择，另一个是分组转发（当一个分组到达时所采取的动作）
  - **（1）路由选择：**根据特定的路由选择协议**构造出路由表**，同时根据相邻的路由表**交换路由信息**，不断更新和维护路由表
  - **（2）分组转发：**路由器根据转发表将用户的IP数据报**从合适的端口转发出去。**

## 4、路由器转发表、默认路径、下一站 

- **转发表[路由表]：**列出所有交换机并都给出**对应下一跳**，要求为**最短路径**。 

  - 只有比自己现存的路径短，交换机的转发表才会变化。

  - 转发到下一跳的过程就称为路由。

  - 路由表的组成：**目的地址+掩码+下一跳**

    - 下图为R2路由表

    <img src="C:\Users\icebear\AppData\Roaming\Typora\typora-user-images\image-20220613010027004.png" alt="image-20220613010027004" style="zoom:67%;" />

- **动态路由**

  - 可以自动更新

- **静态路由**

  - 不能变更路由路径，如果修改了接口则会工作不正常。

- **默认路由**（缺省路由、Default Route）：路由表中一种特殊的静态路由

  - 当网络中报文的路由**无法匹配**到当前路由表中的路由记录时，**缺省路由用来指示路由器或网络主机将该报文发往指定的位置**。缺省路由在路由表中目的地址为0.0.0.0
  - 其实就是把**下一跳相同的条目合并**为单条目[to reach *]，只允许有一个默认路由。 

## 5、网络协议分层的思想：网络互联、虚拟网络的概念 

- 为了简化网络设计的复杂性，通信协议采用分层的结构，各层协议之间既相互独立又相互高效的协调工作。
- 不同层次数据包结构遵循如下形式设计：数据分组由“头部+数据”组成；且每一层“头部+数据”作为下一层的“数据”。
- **统一网络层以下不同的物理帧格式。**在网络的各层中存在着许多协议，接收方和发送方同层的协议必须一致，否则一方将无法识别另一方发出的信息。网络协议使网络上各种设备能够相互交换信息。

## 6、ISO/OSI网络协议的分层模型（七层）

**(1)物理层：**提供为建立、维护和拆除物理链路所需要的机械的、电气的、功能的和规程的特性；有关的物理链路上传输非结构的位流以及故障检测指示。

**(2)数据链路层：**在网络层实体间提供**数据发送和接收**的功能和过程；提供数据链路的流控。

**(3)网络层：**控制分组传送系统的操作、路由选择、拥护控制、网络互连等功能，它的作用是将具体的物理传送对高层透明。

**(4)传输层：**提供**建立、维护和拆除传送连接**的功能；选择网络层提供最合适的服务；在系统之间提供可靠的透明的数据传送，提供端到端的错误恢复和流量控制。

**(5)会话层：**提供两进程之间建立、维护和结束会话连接的功能；提供交互会话的管理功能，如三种数据流方向的控制，即一路交互、两路交替和两路同时会话模式 。

**(6)表示层：**代表应用进程协商数据表示；完成数据转换、格式化和文本压缩。

**(7)应用层：**提供 OSI 用户服务，例如事务处理程序、文件传送协议和网络管理等。

## 7、TCP/IP协议栈（五层） 

## 8、ISO/OSI和TCP/IP分层之间对应关系、数据基本单位、各层的分工作用

 **第一层：物理层，**对应于基本网络硬件。对应 ISO/OSI 参考模型第一层物理层。

**第二层：网络接口层，**它规定了怎样把数据组织成帧及计算机怎样在网络中传输帧。对应 ISO/OSI 参考模型第二层数据链路层。

**第三层：互联网层，**规定了互联网中传输的包格式及从一台计算机通过一个或多个路由器到最终目标的包转发机制。对应 ISO/OSI 参考模型第三层网络层。

**第四层：传输层，**规定怎么样确保可靠性传输。对应 ISO/OSI 参考模型第四层传输层。

**第五层：应用层**，规定了应用程序如何使用互联网。对应 ISO/OSI 参考模型第五至七层会话层、表示层和应用层。

## 9、路由器和交换机的区别

- **（1）每一个路由器与其之下连接的设备，其实构成一个局域网**
  - 交换机工作在路由器之下，就是也就是**交换机工作在局域网内**
- （2）交换机用于**局域网内网的数据转发**
  - 路由器用于**连接局域网和外网**
- （3）路由器可以用来连接不同类型的网络，而交换机不行



# 十、网际协议编址	



## 1、IPV4编址方案

- **分类IP地址**（1981~1993）：将IP地址空间分为五大类，是最基本的编址方法
- **子网划分**（1985~）：主机号的部分位用于表示子网号，对分类地址方法的改进

- **无分类IP地址**（1993~）：灵活调整网络大小

## 2、有类地址（A/B/C/D/E）、无分类和CIDR表示法

### 有类地址⭐

- 根据最前的位内容来确定具体属于哪一类

![img](file:///C:\Users\icebear\AppData\Local\Temp\ksohtml10844\wps79.png)

### 无分类和CIDR表示法⭐

- 地址掩码（Address Masks）

  - 用于指示IP地址中主机所在子网地址的位掩码
  - 由连续的N位1和32 - N位0构成

  - 作用：求取网络地址（网络号） 
  -  **网络前缀 = (目的地址 & 网络掩码)**

- **无类域间路由（Classless Inter Domain Routing）**

- 一般形式： ddd.ddd.ddd.ddd/m
  - **d为网络号，m为掩码中1的个数**（不一定是8的倍数）



## 3、子网划分和子网掩码⭐

- 实现更小的广播域

- IP地址变为**网络号+子网号+主机号**

  - 从主机号借若干位作为子网号，主机号相应减少若干位对。

- 外通讯和子网号无关，内部通讯和子网号有关

- 路由器交换信息时必须提供该信息给其他路由器，路由表也得给出子网掩码。该信息用 

  于找到IP地址中的子网划分。

  <img src="C:\Users\icebear\AppData\Roaming\Typora\typora-user-images\image-20220613010518639.png" alt="image-20220613010518639" style="zoom:50%;" />

## 子网掩码（subnet mask）

- 使用子网掩码可以**找出IP地址中的子网部分**
- 两台计算机各自的IP地址与子网掩码进行“与”运算后，如果得出的结果是相同的，则说明这两台计算机是处于同一个子网络上的（**网络地址相同**），可以进行直接的通讯。

- 路由器在和相邻路由器交换路由信息时，必须把自己所在的网络（子网）掩码告诉相邻路由器。

-  若一个路由器连接在两个子网上，就拥有两个网络地址和两个子网掩码。

  

## 4、特殊IP地址（本机、网络、环回、直接广播、有线广播）

- **回送地址**：127.\*.\*.\*
  - 本地环路地址，仅用于测试，因为流量并不实际经过网卡。

![img](file:///C:\Users\icebear\AppData\Local\Temp\ksohtml10844\wps80.png)

## 5、网络层的广播和多播

- 直接广播地址：**主机号全为1**，接收方为**该网络号下的所有主机**  

  - 主机号正常是超过一位的！

- 有限广播地址：**地址全为1**（255.255.255.255），路由器不转发

- 广播和多播都是在局域网内的。

  

## 6、多穴主机（Multi-Homed Hosts）

- 提高可靠性：如果一个网络失效（拥塞），主机仍可以通过第二连接到达互联网。 
- 多穴主机有多个IP地址。每个网络连接一个地址。
- 有多重连接的原因：负载平衡和速度冗余提高网络可靠性



# 十一、数据报转发、支持协议和相关技术、IPv6



## 1、IPv4数据报格式中的各部分组成（12个）

- 基本信息：**版本[4bit]     服务类型[8bit]     协议类型[8bit]** 

- 长度有关： **报文总长度[16bit]   报头长度[4bit]** 

- 标识：**标识[16bit]   分片标识[3bit]** 

- 地址：**源IP地址[32bit]   目的IP地址[32bit]** 

- 计算：**片偏移[13bit]   TTL[8bit]    报头校验和[16bit]**   

  

- ![image-20220612162112062](C:\Users\icebear\AppData\Roaming\Typora\typora-user-images\image-20220612162112062.png)



## 2、MTU与分片、分片重组和收集⭐

### **MTU**

- **数据链路层支持**的最大传输字节数。 

### 分片

- 路由器把大片（数据报）分成小片，满足MTU。尽量分大片。除最后一片，**每片字节数为8整数倍**。**注意原片和分片开头都有20B的IP头。**

- 原始数据报首部被复制成各数据报片首部，但必须要修改有关字段的值标识：复制，保持初始标识不变
- 分片标志：MF（More Fragment）= 1表示后续还有分片，反之亦然；DF（Don't Fragment）= 1表示不允许分片，反之亦然；
- 片偏移量：表示当前分片在初始IP包中有效数据的偏移位置（单位：8Bytes） 每个分片使用IP数据报格式，并独立发送。

### 分片重组（Reassembly）

- 可能有多次分片
- **所有分片重组在目标端进行，中间路由设备不做分片重组**（减少中间节点的数据处理过程） 碎片可以再分片

### 分片收集

- 目标端对IP报文分片做重组时进行丢失判断

- 对于任意一个报文，在收集到第一个分片后设置一个等待的有限时间T-out，若经过T-out后还没有收到全部分片，则为超时

- **任意一个分片出错或丢失，则丢弃整个报文。**

  

## 3、IP封装、虚拟分组

### 封装（Encapsulation）

- 将IP数据报放入帧的载荷内，并加上帧头/尾

### 虚拟分组（Virtual Packet）

- 网络互联协议定义**独立于底层硬件的“分组”格式**



## 4、IP数据报转发原理、转发过程中的帧头、报文头的情况

- 通过计算（子网掩码 & 路由表中各条目的子网掩码），若按位与结果与该条目的网络号匹配，则下一条即为所求
- 最长前缀匹配（Longest Prefix Match）：若有多个条目能够匹配成功，则选用网络号最长的那个
- （网络掩码中1最多的）
- 通过以上方法选择下一跳后，通过物理网络发送
- 帧达到下一跳，接收方软件提取IP数据报并丢弃帧头/尾，若还需转发则重新封装报文头一直不变



## 5、ARP协议作用（地址解析协议）、概念地址边界

- ARP（Address Resolution Protocol，地址解析协议）协议的作用
  - **将IP地址解析为MAC地址**
- 方法：查表、相近形式计算、消息交换
- 使用ARP的四种典型情况：
  - 主机 -> 本网主机：**找到目的主机的MAC地址**
  - 主机 -> 另一网络上的主机：找到本网络上**路由器的MAC地址**
  - 路由器 -> 本网主机：**找到目的主机的MAC地址**
  - 路由器 -> 另一网络上的主机：找到**另一路由器的MAC地址**
- **ARP报文不会被路由器转发。**
  - 所以实验楼无法通过ARP询问到厦大网站的MAC地址。
  - 查询不同局域网络中的MAC地址是没有意义的！
    - 要通过ARP协议找到**一个位于本局域网上的路由器**的硬件地址，将分组发给这个路由器，再让这个路由器把**分组转发给下一个网络**。
- **关于ff:ff:ff:ff:ff:ff**
  - 如果在ARP缓存表中没有找到相对应的IP地址，主机A就会在网络上发送一个广播**ARP请求分组**，主要内容是：我的IP地址是10.1.1.1，MAC地址00-00-25-AB-EE-9C，我想知道IP地址为10.1.1.2的MAC地址。
  - ”网络上其他主机并不响应ARP询问，只有主机B接收到这个帧时，才向主机A做出这样的回应：“10.1.1.2的MAC地址是00-aa-00-62-c6-09”。
  - 这样，主机A就知道了主机B的MAC地址，它就可以向主机B发送信息了。同时它还更新了自己的ARP缓存表，下次再向主机B发送信息时，直接从ARP缓存表里查找就可以了。
  - ARP缓存表采用了老化机制，在一段时间内如果表中的某一行没有使用，就会被删除，这样可以大大减少ARP缓存表的长度，加快查询速度。

### ARP缓存

- #### **什么是ARP缓存？**

  - 局域网各主机和路由器的 **IP 地址到硬件地址的映射表**。

- #### ARP如何使用其缓存？

  - 当主机 A 欲向**本局域网上的某个主机** B 发送 IP 数据报时，就先在其 ARP高速缓存中查看有无主机 B 的 IP 地址。如有，就可查出其对应的硬件地址，再将此硬件地址写入 MAC 帧，然后通过局域网将该 MAC 帧发往此硬件地址。
  - 为了减少网络上的通信量，**主机 A 在发送其 ARP 请求分组时，就将其 IP地址到硬件地址的映射写入 ARP 请求分组。**
  - 当主机 B 收到 A 的 ARP 请求分组时，就将主机 A 的这一地址映射写入主机 B 自己的 ARP 高速缓存中。

### 概念地址边界

- 工作在**IP地址和MAC地址**之间（2.5层）



## 6、ICMP协议（ping、route、traceroute）工作原理

- ICMP（Internet Control Message Protocol，Internet报文协议）
- 目的
  - 提高IP**数据报交付成功的机会**
- **机制**
  - 主机或路由器**报告差错情况和提供有关异常情况的报告**
  - ICMP报文作为IP层数据报的数据，加上数据报的首部，组成IP数据报发送出去
    - 分为差错报告报文和询问报文。

### 利用ICMP对一个网络的时延进行监控

- ICMP**时间戳请求和应答消息**请求都包含**初始、接收和传送时间戳**。产生ICMP时间戳请求的主机可以使用这三个时间戳估算远程主机的本地时间。
- **往返时间，它的值是收到回答时的时间值减去发送请求时的时间。**

### 不发送ICMP差错报告报文的情况

- 原报文是ICMP差错报告报文
- 除了第一个分片以外的同一数据报片地址为**多播地址**
- 地址为**其它特殊地址**（127.0.0.0、0.0.0.0等）

### PING（Packet Internet Groper，因特网包探索器）

- **概述**
  - 应用层直接使用网络层ICMP（没有通过传输层的TCP/UDP）
    - use raw IP
- **原理**
  - **Ping 用 ICMP 回应请求和回应应答报文来实现。**
  - 当调用 Ping 程序时，它发送一个**包含 ICMP 回应请求**的报文给目的地，然后等待一段很短的时间。
  - 如果没有收到应答，则重新传送请求。如果**重传的请求仍没有收到应答（或收到ICMP 目的不可达报文），Ping 声称该远程机器为不可达。**
  - 远端主机上的ICMP 软件应答该回应请求报文。按照协议只要收到回应请求，ICMP 软件必须发送回应应答。

### TraceRoute

- **原理**
  - TraceRoute **利用 ICMP 及 IP 头部的 TTL（Time To Live）域得到一连串数据包路径。**
  - 如果TTL达到0，则路由器丢弃数据报，并将ICMP超时错误发送回源。
  - 每次将送出的报文的TTL加1来发现另一个路由器，直到该值足够大到数据报到达其最终目标。

### Route

- 打印本机路由表

  

## 7、DHCP协议（动态主机配置）作用

- DHCP（动态主机配置协议）：

  - **从服务器获得IP地址**（时分多路复用，轮流使用IP地址）

    - 指的是由服务器控制一段IP地址范围，客户机登录服务器时就可以自动获得服务器分配的IP地址和子网掩码。

  - **UDP（传输层）**

  - Windows Server的一个服务组件

  - 不一定只能在局域网内请求IP地址。

    

## 8、NAT（**网络地址转换**）和传输层NAT的工作原理、用于NAT的私有地址

- NAT（**网络地址转换**）

  - **私有IP地址映射到公网地址，以减缓IP地址空间的消耗**
  - 将数据包中的IP源地址由站点替换为Internet，并且将IP目的地址由Internet替换为站点

- 传输层NAT（NAPT）：带端口号的NAT，端口号也参与转换（因为终究是追上的应用在上网）    

- 私有地址：NAT内部的地址

  ![image-20220612235041932](C:\Users\icebear\AppData\Roaming\Typora\typora-user-images\image-20220612235041932.png)

- 通过NAT或NATP技术，可使同一站点的多台计算机能共享一个全球有效的IP地址。
- 上图，机房某台主机IP地址为172.10.5.192，子网掩码为255.255.255.0。在搜索引擎查询ip得到59.77.7.12。
- 该主机访问厦大网站（210.34.0.12）时的MAC地址、IP地址、端口号转换过程如上。
  - 80端口是为 HTTP 



## 9、IPv6编址方案

- IPv6短期无法取代的原因
  - 无分类地址、DHCP、NAT等技术提高IPv4地址利用率，延续了IPv4的生命。



# 十二、传输层协议简介、用户数据报协议



## 1、端到端服务与虚拟连接的概念

- 端到端服务：网络通信本质是**两个进程间的通信**，不是主机间通信

- 虚拟连接：传输层隐藏了硬件拓扑、路由细节等，使应用程序直接调用其接口，建立一条**虚拟的端到端的通信信道**

## 2、端口号的作用与编号规则、应用层主要协议与端口号

- 作用：用于表示本机的不同进程

- 编号规则：熟知端口号（0 ~ 1023）、登记端口号（1024 ~ 49151）、客户端口号（49152 ~ 65535）

![img](file:///C:\Users\icebear\AppData\Local\Temp\ksohtml10844\wps81.png) 

 

## 3、UDP的主要特点（无连接、尽力而为、轻量级）

- UDP（User Datagram Protocol，用户数据报协议）
  - 不可靠但高速的传输

- **无连接：**发送数据前不需要建立连接（**连接：对状态/变量的保持，不是对网络的保持**） 
- **可多对多**
- **尽力而为：**不保证可靠交付，同时也不使用拥塞控制

- **轻量级**：首部开销小，只有8Bytes（16bits源地址、16bits目的地址、16bits长度、16bits校验和）

## 4、UDP的应用场景

- 常用于丢包损失不大、应用层可控制丢包的场景

- **面向简单事务：**查询响应协议（域名系统、网络时间协议）、没有完整协议栈的引导（DHCP、TFTP）

- **提供数据报**：构建其他协议（IP隧道、远程过程调用、网络文件系统） 大量客户端：流媒体应用（IPTV）

- **实时应用：**建立在实时流的协议（IP语音、网络游戏）

- **单项沟通：**服务发现和共享信息中的广播信息（广播时间或路由信息协议）

## 5、TCP/UDP实现需求

- UDP实现：
  - DNS、网络校时、IP隧道、远程进程调用、DHCP、TFTP（小文件传输协议）、IPTV、流媒体应用、VoIP、在线游戏、基于实时流协议的协议、广播、路由信息协议、
  - **广播要用UDP**
    - 因为TCP 建立连接需要具体的发送方和接收方，这是一对一的通路。如果允许广播，则接受字节的时候很难区分接收方，也会因为收到多个的确认造成混乱。
- TCP实现：
  - HTTP、FTP、STMP、POPS等。

##  UDP的报文头部格式

- 源端口、目的端口、数据报长度、校验值。



# 十三、传输控制协议⭐	



## 1、TCP的主要特点（面向连接、点对点、可靠、全双工、字节流）

- TCP（Transmission Control Protocol，传输控制协议）
- **面向连接：**收发双方都保有一些状态的信息，使得通讯顺序进行点对点：只允许一对一的通信
- **字节流：**数据像水流一样源源不断地发出和接受
  - 流接口：**以字节位单位封装在报文段内传输。**
  - 将字节写入发送缓存->加上TCP首部变成报文段->发送->从接受缓存读取然后去掉首部。
  - TCP连接是一条**虚连接**，不是真正的物理连接
  - 收到的报文段不一定按顺序，**最后要按报文段的首部序号排序连接。** 
- **可靠：**TCP保证接收到的数据一定是完整、可靠的
- **全双工：**TCP在发送的同时可以接收

## 2、TCP段格式中的各部分组成

- 端口：**源端口[16bit]、目的端口[16bit]**

- 标识号码：**序号[32bit]、确认号[32bit]、标志字段[8bit]、紧急指针[16bit]****

- **首部长度[4bit]、保留位[4bit]、滑动窗口缓冲区[16bit]、校验和[16bits]**

- **选项字段**

  

<img src="C:\Users\icebear\AppData\Roaming\Typora\typora-user-images\image-20220612192324148.png" alt="image-20220612192324148" style="zoom:80%;" />

## 3、TCP的基本工作原理（应答、超时、重传、窗口机制） 应答

- 接收方收到正确的报文后便发送确认消息，若多次收到相同的报文，则保留最后一次收到的报文，并  且对每一个报文进行确认

## 超时重传

- TCP每发送一个报文段，就设置一个计时器，在计时器设置的重传时间到之前没有收到确认报文，就要重传该报文段（对重复收到的确认报文不予理睬）

## 连续自动重传请求的窗口机制

- **逐一确认**：窗口内的分组连续发送，不需要等待确认。**每收到一个确认，窗口往前推移一格**

- **累计确认：**接收方收到几个分组后，对最后一个窗口进行确认。

- **发送和接受缓存：** 

  - 发送：应用程序要发的数据和已发还没收到确认的数据； 

  - 接受：已按序到达但还没被应用程序读走的数据和不按序到达的数据；

- **虚连接：** 
  - 非真正的物理连接。不关心应用发的消息长度，而是根据**窗口值和拥塞程度**来决定报文段长度。 

## 4、TCP的流量控制机制（滑动窗口）

### 流量控制的原因

- 流量控制主要针对数据段的接收方（由于忙）处理数据长度有限的时候，对发送数据的速度进行控制。

### 流量控制机制

- TCP 采用**接收方不断报告窗口大小的机制进行流量控制**，即报告当前可以处理的报文的最大长度。TCP 收到窗口为 0 的时候，停止发送，启动一个计时器，到计时器为零的时候重新发送。



## 5、TCP的拥塞（congestion）控制（慢开始、拥塞避免、快重传、快恢复、随机早期检测）

- 拥塞窗口（cwnd）：发送方维持的状态变量。

- **慢开始：**TCP初始化时，拥塞窗口置为1，发送方每收到一个对新报文的确认（不计算重传），就使cwnd（Congestion Window，拥塞窗口）加1，达到门限值（初始为16）改用拥塞避免算法。

- **拥塞避免：**把拥塞窗口控制为**按线性规律增长**，使网络较**不容易拥塞**。

- **快重传：**接收方每收到一个失序的报文段后就立即发出重复确认（使发送方及早知道报文段有没有到达对方），**发送方只要一连收到三个重复确认就应当立即重传。**
-  **快恢复：**发送方收到三个重复确认时，就执行“乘法减小”算法使**门限值减半，且执行拥塞避免算法**。
- **随即早期检测RED（Random Early Detection**）：
  - 设置最小门限和最大门限，分组到达时，计算平均队列长度。 
  - 最小门限内的数据**排队发送**，最小门限~最大门限内的数据**概率丢弃**，最大门限外的数据**直接丢** **弃。**

<img src="C:\Users\icebear\AppData\Roaming\Typora\typora-user-images\image-20220613012658216.png" alt="image-20220613012658216" style="zoom:67%;" />



## 6、TCP的连接建立与解除（三次握手、四次挥手）⭐

- 设A为客户端，B为服务器端

### 连接建立⭐

- A客户端、B服务端

- 三次握手

  - A发送请求报文： **SNY（首部同步位） = 1, seq = x**

  - B收到后，若同意则发回确认报文段：**SYN （首部同步位）=1, ACK = 1, seq = y, ack = x + 1** 
  - A收到后，再次确认返回: **ACK = 1, seq = x + 1, ack = y + 1 **
  - A的TCP通知上层应用进程，连接已经建立；
  - B收到A的确认报文后，也通知上层应用进程TCP连接已经建立）

- SYN：同步标记，ACK：确认标记，seq：发送数据序列号，ack：接收数据序列号

### 连接解除⭐

- 四次挥手：双方都可以主动。 

  - 假设A先。A发送解除报文段：**FIN=1，seq=u**； 

  - B发出确认，**ACK=1，seq=v，ack=u+1；**此时B通知应用程序，A->B的连接解除； 
  - <u>此时若B发送数据，A仍要接受。</u>

  - B再发，表示没有要向A发送的数据，**FIN=1，ACK=1，seq=w，ack=u+1；** 

  - A收到，确认：**ACK=1，seq=u+1，ack=w+1；**A等待两个最长报文寿命后，B->A也解除；

<img src="C:\Users\icebear\AppData\Roaming\Typora\typora-user-images\image-20220612201111949.png" alt="image-20220612201111949" style="zoom:80%;" />



## 7、传输层如何解决网络层存在的主要问题（丢包、重复、乱序）

- **停等协议**
  - **发送、停止、等待确认**，超过一定时间没收到**确认**，则**重传**。 
  - 简单但信道利用率低。可用流水线[即连续自动重传请求]提高效率。
- **解决乱序的问题：**
  - 用 ID 号对发送的字节**编号**，使得乱序到达的字节可以按序号重新排列。（**编号**）
- **解决丢包的问题**：
  - 收到（以下指的是正确收到）数据段以后发送确认。（**确认**信息）
  - 如果超过一段时间没有收到即进行重传（自动**重传**请求机制）。
- 解决重复问题：
  - 对多次收到的数据段或确认，只保留**正确到达且最先到达**的那个数据段。
    - TCP 传输单位是“段”不是“报”

## 8、流量控制和拥塞控制

- 流量控制是指**抑制发送端发送数据的速率**，以便使接收端来得及接收。
- 拥塞控制是指**防止过多的数据注入到网络中**，使网络中的路由器或链路不致过载。



# 十四、因特网路由与路由协议



## 1、静态路由与动态路由

- **静态路由选择策略**（非自适应路由选择）
  - 简单、开销较小，但不能及时适应网络的变化
  - 静态路由信息可以手动修改。
  -  **Most Internet hosts** use static routing.
- **动态路由选择策略**（自适应路由选择）
  - 能较好地适应网络状态的变化，但实现较复杂，开销较大
- **比较**
  - 静态路由简便、可靠，在负荷稳定、拓扑变化不大的网络中运行效果很好。
  - 动态路由算法能改善网络的性能并有助于流量控制。

## 2、自治系统（AS）的概念

- 自治系统（Autonomous  System）
  - **在单一的技术管理下的一组路由器，**尽管一个AS可能使用多种内部路由选择协议和度量。
  - 但重要的是一个AS对其它AS表现出的是一个**单一的和一致的路由选择策略**

## 3、内部网关协议（IGP）、外部网关协议（EGP）

- 内部网关协议（Interior Gateway Protocol）：
  - 在一个自治系统内部使用的路由选择协议
- 外部网关协议（External Gateway Protocol）：
  - **自治系统边界网关**使用的路由选择协议。
  - 从一个自治系统到另一个自治系统。

## 4、RIP协议、OSPF协议的工作原理和特点

### 路由信息协议（Routing Information Protocol，RIP）

- 路由信息协议（RIP）是一种**内部网关协议（IG[）**。
- **特点：**
  - 它是自治系统范围内的路由；**使用 UDP 进行不可靠传输；**
  - 采用跳（hop）计数度量：路由器到直接连接网络的距离为1
  - 距离-矢量算法：**每个路由器维护自己到其他目的网络的距离，仅和相邻路由器交换自己的路由表。**
- **优点：**实现简单开销小
- **缺点：**限制网络规模、出现故障要较长时间传送、网络规模增加开销增加。
- **场景：**连接多个路由器的中小型网络。

<img src="C:\Users\icebear\AppData\Roaming\Typora\typora-user-images\image-20220612211432605.png" alt="image-20220612211432605" style="zoom:80%;" />

- ⭐Net2同样的下一跳，替换。
  - RIP报文本来就来自C，只要下一跳目的网络相同，就要替换成新的，哪怕跳数增多了，因为这个新的报文才是最新的状态，之前那个跳数少但是是旧状态。
- 对地址为X的相邻路由器发来的RIP报文，先修改此报文中的所有项目，把下一跳改为X，**把所有距离字段的值加1**

### 开放最短路径优先（Open Shortest Path First，OSPF）

- 分布式的**链路状态协议**（Dijkstra最短路径算法）
  - **link state routing**

- 向本自治系统中的**所有路由器发送信息**（洪泛法）
  - 发送的信息是与本路由器相邻的所有路由器的链路状态（与哪些路由器相邻以及链路的度量（metric））
  - 只有当链路状态发生变化时才发送。
  - 泛洪法仅限于区域内，减少了通信量。区域内部只知道本区域，主干区域为0.0.0.0，连接下层区域。

- OSPF将自治系统**划分成区域**（因为每个路由器都知道自己区域内的完整区域信息）
  - 每个区域有32位的标识符，区域不要超过200个。

- OSPF**直接使用IP数据报**，而且很短，没有消息传的慢的缺点。

### 中间系统到中间系统协议（IS-IS）

- 内部网关协议。
- 私有协议，为OSPF传递路径，开销小。

### RIP/OSPF比较

（1）RIP协议仅向自己**相邻**的几个路由器发送信息，而OSPF向自治系统中的所有路由器发送信息（**洪泛法，广播**） 

（2）RIP发送的信息是**整个路由表**，而OSPF发送的是与本路由器相邻的所有路由器的**链路状态**

（3）RIP协议中，不管网络拓扑是否发生变化，路由器之间都会**定期交换路由表信息**，而OSPF只有**当链路状态发生变化**时才发送信息

（4）RIP会有**坏消息传得慢**的情况，而OSPF更新过程收敛的快。 

（5）RIP是**应用层**协议，它在传输层使用**UDP**协议，而OSPF是**网络层**协议，它使用**IP**数据报进行传送



## 5、BGP协议（边界网关协议）的工作原理和特点

- 边界网关协议（BGP）是一种**外部网关协议（EGP）**。
  - 不是找最佳路由，而是找能到达且不绕圈的路由。
  - 每个AS要选一个路由器作为BGP发言人，BGP发言人要建立TCP连接交换可达性信息。
- **特点：**
  - 它是自治系统之间的路由；
  - 允许发送者和接受者加入政策性约束，限制一些路径不通告到外部；
  - 允许自治系统提供中转业务为中转系统，或不提供中转而作为残存系统；
  - **利用 TCP 协议提供可靠传输。**
- **应用场景：**用于全球因特网中的自治系统之间。



# 十五、网络编程与Socket API



## 1、客户端-服务器端（C/S）交互模式工作原理

- 交互模式是一种分布式的应用结构计算，在任务或工作负载的资源或服务的提供者和服务请求者之间。

## 客户端

- **主动打开、主动结束**

## 服务器端

- **被动打开、响应请求**

## 2、并发的概念

- 允许多个应用在同一时间执行的计算机系统。C-S交互模式的基础

## 3、Socket结构、半相关与全相关

- Socket接口：是**应用程序的基本网络接口，由操作系统提供、进程的通信端点**。

- **Socket结构：五元组**

  - 本地套接字地址（本地IP地址、本地端口号）

  - 远程套接字地址（远程IP地址、远程端口号）

  - 协议（TCP/UDP/原始IP）

- **半相关（half-association）**
  - 网络中（协议、本地地址、本地端口号）在全局唯一**标志一个进程（连接的半部分）**

- **相关（association）**
  - 网络中用（协议、本地地址、本地端口号、**远程地址、远程端口号**）**标识一个完整的网间通信**

- 两个协议相同的半相关能够组成一个全相关

## 4、服务器与用户（硬件）、服务器端与客户端（软件）、二者区别

- **硬件：**客户设备和服务器设备（需要有强大的硬件）
- **软件：**客户端和服务器端是相对的。
  - **客户端可以是任意的应用程序；直接由客户调用（只执行一次会 话）；主动与服务器接触；**可以按需访问多个服务，但同时只能主动连接一个远程服务器。
  - **服务器端是提供服务的专门程序，可以同时处理多个远程客户端；**系统启动时自调用，通过多个会话连续执行；在 共享计算机上运行；被动地等待来自任意远程客户的联系；提供单一服务。
- **区别：**
  - 服务器是一个系统，响应计算机网络上的请求以提供或帮助提供网络服务；
  - 客户端是一个计算机硬件或软件服务器提供的服务的一块。

## 5、Socket API主要函数

| socket  | 创建一个绑定到特定传输服务提供者的插口； |
| ------- | ---------------------------------------- |
| bind    | 将本地地址关联到socket上；               |
| connect | 建立到一个给定套接字的连接；             |
| listen  | 将套接字置于侦听传入连接的状态；         |
| accept  | 允许套接字上的传入连接尝试；             |
| send    | 把数据发送到已连接的套接字；             |
| recv    | 从连接套接字接受数据；                   |
| close： | 关闭插口；                               |



## 6、基于流模式的客户端、服务器端Socket API调用流程⭐

- We use **<u>stream</u>** socket with a connection-oriented protocol。

##  7、基于报文模式的客户端、服务器端对Socket API调用流程⭐

### 不需要listen和accept的原因

- 差异在于无连接的情况下服务器端没有侦听和接受的环节。因为listen函数的主要目的是为了使套接字状态变成监听状态，用来监听新的连接，然后用accept函数获取接受新连接。
- 而无连接的情况下不需要直接建立连接即直接发送。

### 流程图⭐

<img src="C:\Users\icebear\AppData\Roaming\Typora\typora-user-images\image-20220612203548791.png" alt="image-20220612203548791" style="zoom: 67%;" />  



# 十六、传统的因特网应用	

- 提高Web用户体验
  - 负载均衡、内容缓存加速、内容分发网络（CND）、购置处理能力更高的服务器。

## 1、HTTP工作原理与过程、错误代码、URL、HTML文档

- HTTP（HyperText Transfer Protocol，超文本传送协议）

  - 用于规范**浏览器如何与Web服务器交换数据**的传输协议。

  - 过程：**建立TCP连接，客户端发送HTTP请求报文、服务器端发送HTTP响应报文，释放TCP连接**

- URL（Uniform Resource Locator，统一资源定位符）
  - 用于规范**网页识别符的格式和含义**的标准。
  - 错误代码：**4XX表示客户的差错**，**5XX表示服务器的差错**

- HTML（HyperText Markup Language，超文本标记语言）

  - 用于规范网页内容和排版布局的表示标准。

  - 是一种可以用任何文本编辑器创建的ASCII码文件

    

## 在浏览器输入网址并输入回车后发生的事件

- 1、浏览器分析超链指向页面的URL

- 2、浏览器向**DNS请求解析网址的IP地址域名**系统解析出网址的IP地址

- 3、浏览器与服务器**建立TCP连接**

- 4、浏览器发出**取文件命令**

- 5、服务器给出响应，把文件发送给浏览器

- 6、**TCP连接释放**

- 7、浏览器显示文件中的所有文本

  

## 2、FTP工作原理与通信模式、主动和被动工作模式

### 文件传输协议（File Transfer Protocol，FTP）

- **TCP连接**
- 提供交互式的访问，允许用户指明文件类型、格式，允许文件有存取权限屏蔽计算机系统的细节，适合**在异构网络中**任意计算机之间传送文件

- **基于流的C/S模式**，一个FTP服务器**能够同时为多个客户端进程提供服务**

- 由一个接受新的请求的主进程和若干个处理单个请求的从进程组成使用两个端口号，**端口21提供控制连接，端口20提供数据连接**

### 客户端与服务端

- 服务器端被动等待来自客户的连接请求，而客户端主动发起连接请求。**当需要传输数据时**，FTP 新开通数据连接，专门用于传输文件数据。此时，客户起到像**服务器（等待数据连接）**那样的作用，原来的服务器却起到像**客户（发起数据连接）**那样的作用。

### 客户端数据连接模式

- **FTP 的控制连接有验证功能，而数据连接却没有。**数据连接接受用户的访问是基于服务器控制连接的验证结果。**服务器可以从控制连接知道客户端的 IP 地址，如需标识用户程序，还需要知道客户的端口号。**

- 主动模式PORT：**客户端主动**提供端口号请求服务器端连接
  - 客户做服务器端使用，确定其端口号。此时，服务器端用 20 号端口连接它。

- 被动模式PASV：**服务器端提供端口号**使客户端连接（容易被冒用，但易于在NAT模式下使用）
  - 一些简单轻便的 FTP 客户端使用 PASV 模式**（发数据也是主动打开）**，客户提出数据连接的请求并通过服务器验证后，**客户机器上任意程序如果监听到服务器打开的端口号，它们都能够往该端口接收或发送数据。**



## 3、邮件传输协议（SMTP、POP3、IMAP4）的工作原理、MUA、MTA和MDA的定义

<img src="file:///C:\Users\icebear\Documents\Tencent Files\1822327087\Image\C2C\49B52BB081F19D2BA5953242DC1F2B62.jpg" alt="img" style="zoom:80%;" />

- 发件人 -- **SMTP** -->发送方服务器 -- **SMTP** --> 接收方服务器 -- **POP3** --> 收件人

- SMTP
  - 用户的客户端程序U1到电子邮件服务器M1
  - **源电子邮件服务器M1到目标电子邮件服务器M2**



### 概述

- SMTP：端口号25；发送邮件的协议。
- POP3：端口号110；访问邮件的协议。**只支持对邮件的下载和删除，可以离线查看文件。**
- IMAP4：端口号143；访问邮件的协议。**支持对邮件目录的维护，支持只下载邮件主题。**



### SMTP（Simple Mail Transfer Protocol，简单邮件传输协议）

- TCP连接，**端口号：25（明文）**

- 遵循流范式、使用文本控制信息、只传送文本消息、发送一个给定消息的副本、允许客户端列出用户，然后向列表中所有用户发送消息的单个副本（允许副本再发到多个目的地）

- **连接建立 -- 邮件传送 -- 连接释放**

- 用命令在MTA客户端和MTA服务器端传输消息

- 命令格式：KEYWORD: INFO（关键字 + “: ” + 信息）

- 响应（服务器端到客户端）：三位数的代码，后面可能有额外的文本信息

### POP3（邮局协议）

- TCP连接**，端口号：110（明文）**
- **允许用户通过PC机动态地检索邮件服务器上的邮件**

- 授权状态：验证用户名、密码

- 事务状态：检索邮件、删除（做删除标记）邮件等

- 更新状态（QUIT命令后）：删除标记邮件，关闭TCP连接，释放资源，会话结束阅读邮件时可以不上网

### IMAP4（Internet Mail Access Protocol，Internet邮件访问协议）

- **端口号143（明文）**
- 三种工作模式：离线、在线和断连

- **不支持下载邮件内容**，可以同时多个用户访问服务器
- 支持对邮箱目录的维护。

### MUA（Mail User Agent，邮件用户代理）

- **帮助用户读取、编写、回复文件**，再将这些信息转给MTA发送

### MTA（Mail Transport Agent，邮件传输代理）

- 把邮件**从一个服务器传到另一个服务器**或**邮件投递代理**

### MDA（Mail Delivery Agent，邮件投递代理）

- 将MTA接受的邮件，**根据收件人地址投放到用户的邮箱里**；在投放过程中，还可以进行邮件过滤、自动回复等功能

### MIME（Multipurpose Internet Mail Extensions）

- 允许SMTP发送**非ASCII数据**的补充协议
- 发送邮件的协议。
- **在接收端服务器的SMTP接受ASCII数据后转换为原始数据**
- **邮件格式（7种）**：
  - **Text：**文本
  - **Multipart：**连接消息体的多个部分构成一个消息，这些部分可以是不同类型的数据。
  - **Application：**应用程序或二进制数据
  - **Message：**用于包装一个E-mail消 息  
  - **Image：**静态图片
  - **Audio**：音频      
  - **Video：**动态影像数据、音视频
- RAR文件的首部：application/octet-stream
- 大附件不是用MIME形式直接发送的，而是将**大附件存在存储服务器**上，并将**下载链接放入 HTML 块中**，附在邮件后。



## Base64编码

- 每6个二进制位解释成一个打印字符

  

## 4、域名系统（DNS）工作原理

- DNS系统采用客户端/服务器，使用的传输层协议为**TCP或UDP**

### DNS层次结构

- 拓扑结构和计算效率。
  - 如果组织将所有名称都放在单一的服务器上，拓扑查找是最快的，然而，**出于管理的原因**，最好有多个服务器，使用层次划分的名称。
  - 在计算效率上，如果过多服务器被请求，查找会慢下来。因此，如果只是一个小组织，同时发生的查找不多，单一服务器将运行良好。

<img src="C:\Users\icebear\AppData\Roaming\Typora\typora-user-images\image-20220613013752048.png" alt="image-20220613013752048" style="zoom:67%;" />

### 概念

- 域名系统（Domain Name  System，DNS）提供了将**人类可读符号域名映射到计算机地址**的服务分布式：
  - 名字到IP地址的解析由若干个**域名服务器程序**完成。
  - 域名服务器程序在专设的节点上运行，运行该程序的机器称为域名服务器
- 域名：因特网上的**主机/路由器**所具有的**唯一的层次结构的名字**
- 层次树状结构：由标号序列组成，各标点之间用点隔开从后往前依次为：顶级域名-二级域名-三级域名……
- **根域名服务器**（13个IP地址）（Root Name Server，RNS）：是最重要的域名服务器，存储所有顶级域名服务器的地址信息
- **顶级域名服务器**：管理在该顶级域名服务器注册的所有二级域名权限域名服务器：负责一个区的域名服务器
- **本地域名服务器**（Local Name Server，LNS）：主机发出DSN查询请求时，查询请求报文就发送给本地域名服务器，对域名系统非常重要
- 每台主机应该知道本地域名服务器的地址，每台LNS应该知道RNS的地址
- 查询路径：主机 --> **本地域名服务器 --> 根域名服务器 --> 顶级域名服务器 --> 权限域名服务器** --> 权限域名服务器 --> ...

### DNS轮询

- 一个域名配多个IP实现负载均衡
  - DNS 服务器将解析请求按照记录顺序，逐一分配到不同的 IP 上。这样就完成了简单的负载均衡。

### 迭代和递归查询

- 当主机所询问的本地服务器不知道被查询域名的IP地址

- **递归查询（较少）**：**以客户端的身份向下一 台域名服务器查询。**

  - 如果主机所询问的本地域名服务器不知道被查询域名的IP 地址，**则本地域名服务器以 DNS 客户的身份**，向根域名服务器继续发出查询请求报文（即替该主机继续查询），而不是让该主机自己进行下一步的查询。
  - 因此，递归查询返回的查询结果**或者是所要查询的 IP 地址，或者是报错**，表示无法查询到所需的 IP 地址。

- **迭代查询：**返回本地域名服务器**应查询的下 一台域名服务器的IP地址。**

  - 当根域名服务器收到本地域名服务器发出的迭代查询请求报文时，要么给出所要查询的 IP 地址，要么告诉本地域名服务器，下一步应当向哪一个域名服务器进行查询。**然后让本地域名服务器进行后续的查询**（而不是替本地域名服务器进行后续的查询）。
  - 根域名服务器通常是把自己知道的顶级域名服务器的 IP 地址告诉本地域名服务器，**让本地域名服务器再向顶级域名服务器查询。**
  - 顶级域名服务器在收到本地域名服务器的查询请求后，**要么给出所要查询的 IP 地址，要么告诉本地域名服务器下一步应该向哪一个权限域名服务器进行查询。**最后，知道了所要解析的域名的 IP 地址，然后把这个结果返回给发起查询的主机。

  

